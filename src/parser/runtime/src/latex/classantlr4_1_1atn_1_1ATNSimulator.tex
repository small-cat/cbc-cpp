\hypertarget{classantlr4_1_1atn_1_1ATNSimulator}{}\section{antlr4\+:\+:atn\+:\+:A\+T\+N\+Simulator Class Reference}
\label{classantlr4_1_1atn_1_1ATNSimulator}\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}


Inheritance diagram for antlr4\+:\+:atn\+:\+:A\+T\+N\+Simulator\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=243pt]{classantlr4_1_1atn_1_1ATNSimulator__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for antlr4\+:\+:atn\+:\+:A\+T\+N\+Simulator\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{classantlr4_1_1atn_1_1ATNSimulator__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_aea00369023c5b32d3b73e9e4b2726cbe}\label{classantlr4_1_1atn_1_1ATNSimulator_aea00369023c5b32d3b73e9e4b2726cbe}} 
{\bfseries A\+T\+N\+Simulator} (const A\+TN \&atn, Prediction\+Context\+Cache \&shared\+Context\+Cache)
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a282a76fb17fd8529c48e695b4dc5134c}\label{classantlr4_1_1atn_1_1ATNSimulator_a282a76fb17fd8529c48e695b4dc5134c}} 
virtual void {\bfseries reset} ()=0
\item 
virtual void \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_a3358fa3e8ebcb4abeeceb914b0b07f10}{clear\+D\+FA} ()
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a112cafa9554cff202c037672ddc918e5}\label{classantlr4_1_1atn_1_1ATNSimulator_a112cafa9554cff202c037672ddc918e5}} 
virtual Prediction\+Context\+Cache \& {\bfseries get\+Shared\+Context\+Cache} ()
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_aa4fb144eaf79bf6052a0abe290f7a3a2}\label{classantlr4_1_1atn_1_1ATNSimulator_aa4fb144eaf79bf6052a0abe290f7a3a2}} 
virtual Ref$<$ \hyperlink{classantlr4_1_1atn_1_1PredictionContext}{Prediction\+Context} $>$ {\bfseries get\+Cached\+Context} (Ref$<$ \hyperlink{classantlr4_1_1atn_1_1PredictionContext}{Prediction\+Context} $>$ const \&context)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static A\+TN \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_ae516df637ee1f4be4787d533ed88b3b9}{deserialize} (const std\+::vector$<$ uint16\+\_\+t $>$ \&data)
\item 
static void \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_aa827be017f3bf3a431ef91972d38e3d1}{check\+Condition} (bool condition)
\item 
static void \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_a394cdeb1e2d6028bc73e0f1d22830b3d}{check\+Condition} (bool condition, const std\+::string \&message)
\item 
static \hyperlink{classantlr4_1_1atn_1_1Transition}{Transition} $\ast$ \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_a8e3fc8caefaecf90ac5eb45561aafdcc}{edge\+Factory} (const A\+TN \&atn, int type, int src, int trg, int arg1, int arg2, int arg3, const std\+::vector$<$ \hyperlink{classantlr4_1_1misc_1_1IntervalSet}{misc\+::\+Interval\+Set} $>$ \&sets)
\item 
static A\+T\+N\+State $\ast$ \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_a57878604b6496cc6aa80e29811e05660}{state\+Factory} (int type, int rule\+Index)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_afec8e232a4c11c864ecc770252a2bcb6}\label{classantlr4_1_1atn_1_1ATNSimulator_afec8e232a4c11c864ecc770252a2bcb6}} 
const A\+TN \& {\bfseries atn}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a1a88e9a52986711b319268c6e6faf6c6}\label{classantlr4_1_1atn_1_1ATNSimulator_a1a88e9a52986711b319268c6e6faf6c6}} 
static const Ref$<$ dfa\+::\+D\+F\+A\+State $>$ \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_a1a88e9a52986711b319268c6e6faf6c6}{E\+R\+R\+OR} = std\+::make\+\_\+shared$<$D\+F\+A\+State$>$(I\+N\+T32\+\_\+\+M\+AX)
\begin{DoxyCompactList}\small\item\em Must distinguish between missing edge and edge we know leads nowhere. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
Prediction\+Context\+Cache \& \hyperlink{classantlr4_1_1atn_1_1ATNSimulator_a73bf77d58d1457cc0543600da3201bea}{\+\_\+shared\+Context\+Cache}
\begin{DoxyCompactList}\small\item\em The context cache maps all \hyperlink{classantlr4_1_1atn_1_1PredictionContext}{Prediction\+Context} objects that are equals() to a single cached copy. This cache is shared across all contexts in all A\+T\+N\+Configs in all D\+FA states. We rebuild each \hyperlink{classantlr4_1_1atn_1_1ATNConfigSet}{A\+T\+N\+Config\+Set} to use only cached nodes/graphs in add\+D\+F\+A\+State(). We don\textquotesingle{}t want to fill this during closure() since there are lots of contexts that pop up but are not used ever again. It also greatly slows down closure(). 

This cache makes a huge difference in memory and a little bit in speed. For the Java grammar on java.$\ast$, it dropped the memory requirements at the end from 25M to 16M. We don\textquotesingle{}t store any of the full context graphs in the D\+FA because they are limited to local context only, but apparently there\textquotesingle{}s a lot of repetition there as well. We optimize the config contexts before storing the config set in the D\+FA states by literally rebuilding them with cached subgraphs only. 

I tried a cache for use during closure operations, that was whacked after each adaptive\+Predict(). It cost a little bit more time I think and doesn\textquotesingle{}t save on the overall footprint so it\textquotesingle{}s not worth the complexity. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a0ceff3caefbd8f9067c549fdf60e973b}\label{classantlr4_1_1atn_1_1ATNSimulator_a0ceff3caefbd8f9067c549fdf60e973b}} 
static \hyperlink{classantlrcpp_1_1SingleWriteMultipleReadLock}{antlrcpp\+::\+Single\+Write\+Multiple\+Read\+Lock} {\bfseries \+\_\+state\+Lock}
\item 
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_ab3c0921267abe8227f51aa4f1201a82a}\label{classantlr4_1_1atn_1_1ATNSimulator_ab3c0921267abe8227f51aa4f1201a82a}} 
static \hyperlink{classantlrcpp_1_1SingleWriteMultipleReadLock}{antlrcpp\+::\+Single\+Write\+Multiple\+Read\+Lock} {\bfseries \+\_\+edge\+Lock}
\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_aa827be017f3bf3a431ef91972d38e3d1}\label{classantlr4_1_1atn_1_1ATNSimulator_aa827be017f3bf3a431ef91972d38e3d1}} 
\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}!check\+Condition@{check\+Condition}}
\index{check\+Condition@{check\+Condition}!antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}
\subsubsection{\texorpdfstring{check\+Condition()}{checkCondition()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void A\+T\+N\+Simulator\+::check\+Condition (\begin{DoxyParamCaption}\item[{bool}]{condition }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000002}{Deprecated}]Use \begin{DoxySeeAlso}{See also}
A\+T\+N\+Deserializer\+::check\+Condition(boolean)


\end{DoxySeeAlso}
instead. \end{DoxyRefDesc}
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a394cdeb1e2d6028bc73e0f1d22830b3d}\label{classantlr4_1_1atn_1_1ATNSimulator_a394cdeb1e2d6028bc73e0f1d22830b3d}} 
\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}!check\+Condition@{check\+Condition}}
\index{check\+Condition@{check\+Condition}!antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}
\subsubsection{\texorpdfstring{check\+Condition()}{checkCondition()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void A\+T\+N\+Simulator\+::check\+Condition (\begin{DoxyParamCaption}\item[{bool}]{condition,  }\item[{const std\+::string \&}]{message }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000003}{Deprecated}]Use \begin{DoxySeeAlso}{See also}
A\+T\+N\+Deserializer\+::check\+Condition(boolean, String)


\end{DoxySeeAlso}
instead. \end{DoxyRefDesc}
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a3358fa3e8ebcb4abeeceb914b0b07f10}\label{classantlr4_1_1atn_1_1ATNSimulator_a3358fa3e8ebcb4abeeceb914b0b07f10}} 
\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}!clear\+D\+FA@{clear\+D\+FA}}
\index{clear\+D\+FA@{clear\+D\+FA}!antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}
\subsubsection{\texorpdfstring{clear\+D\+F\+A()}{clearDFA()}}
{\footnotesize\ttfamily void A\+T\+N\+Simulator\+::clear\+D\+FA (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Clear the D\+FA cache used by the current instance. Since the D\+FA cache may be shared by multiple A\+TN simulators, this method may affect the performance (but not accuracy) of other parsers which are being used concurrently.


\begin{DoxyExceptions}{Exceptions}
{\em \hyperlink{classantlr4_1_1UnsupportedOperationException}{Unsupported\+Operation\+Exception}} & if the current instance does not support clearing the D\+FA.\\
\hline
\end{DoxyExceptions}
\begin{DoxySince}{Since}
4.\+3 
\end{DoxySince}


Reimplemented in \hyperlink{classantlr4_1_1atn_1_1ParserATNSimulator_a846da7dc607b212d443cb401f5830bae}{antlr4\+::atn\+::\+Parser\+A\+T\+N\+Simulator}.

\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_ae516df637ee1f4be4787d533ed88b3b9}\label{classantlr4_1_1atn_1_1ATNSimulator_ae516df637ee1f4be4787d533ed88b3b9}} 
\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}!deserialize@{deserialize}}
\index{deserialize@{deserialize}!antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}
\subsubsection{\texorpdfstring{deserialize()}{deserialize()}}
{\footnotesize\ttfamily A\+TN A\+T\+N\+Simulator\+::deserialize (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ uint16\+\_\+t $>$ \&}]{data }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000001}{Deprecated}]Use \begin{DoxySeeAlso}{See also}
A\+T\+N\+Deserializer\+::deserialize


\end{DoxySeeAlso}
instead. \end{DoxyRefDesc}
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a8e3fc8caefaecf90ac5eb45561aafdcc}\label{classantlr4_1_1atn_1_1ATNSimulator_a8e3fc8caefaecf90ac5eb45561aafdcc}} 
\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}!edge\+Factory@{edge\+Factory}}
\index{edge\+Factory@{edge\+Factory}!antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}
\subsubsection{\texorpdfstring{edge\+Factory()}{edgeFactory()}}
{\footnotesize\ttfamily \hyperlink{classantlr4_1_1atn_1_1Transition}{Transition} $\ast$ A\+T\+N\+Simulator\+::edge\+Factory (\begin{DoxyParamCaption}\item[{const A\+TN \&}]{atn,  }\item[{int}]{type,  }\item[{int}]{src,  }\item[{int}]{trg,  }\item[{int}]{arg1,  }\item[{int}]{arg2,  }\item[{int}]{arg3,  }\item[{const std\+::vector$<$ \hyperlink{classantlr4_1_1misc_1_1IntervalSet}{misc\+::\+Interval\+Set} $>$ \&}]{sets }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000004}{Deprecated}]Use \begin{DoxySeeAlso}{See also}
A\+T\+N\+Deserializer\+::edge\+Factory


\end{DoxySeeAlso}
instead. \end{DoxyRefDesc}
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a57878604b6496cc6aa80e29811e05660}\label{classantlr4_1_1atn_1_1ATNSimulator_a57878604b6496cc6aa80e29811e05660}} 
\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}!state\+Factory@{state\+Factory}}
\index{state\+Factory@{state\+Factory}!antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}
\subsubsection{\texorpdfstring{state\+Factory()}{stateFactory()}}
{\footnotesize\ttfamily A\+T\+N\+State $\ast$ A\+T\+N\+Simulator\+::state\+Factory (\begin{DoxyParamCaption}\item[{int}]{type,  }\item[{int}]{rule\+Index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000005}{Deprecated}]Use \begin{DoxySeeAlso}{See also}
A\+T\+N\+Deserializer\+::state\+Factory


\end{DoxySeeAlso}
instead. \end{DoxyRefDesc}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classantlr4_1_1atn_1_1ATNSimulator_a73bf77d58d1457cc0543600da3201bea}\label{classantlr4_1_1atn_1_1ATNSimulator_a73bf77d58d1457cc0543600da3201bea}} 
\index{antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}!\+\_\+shared\+Context\+Cache@{\+\_\+shared\+Context\+Cache}}
\index{\+\_\+shared\+Context\+Cache@{\+\_\+shared\+Context\+Cache}!antlr4\+::atn\+::\+A\+T\+N\+Simulator@{antlr4\+::atn\+::\+A\+T\+N\+Simulator}}
\subsubsection{\texorpdfstring{\+\_\+shared\+Context\+Cache}{\_sharedContextCache}}
{\footnotesize\ttfamily Prediction\+Context\+Cache\& antlr4\+::atn\+::\+A\+T\+N\+Simulator\+::\+\_\+shared\+Context\+Cache\hspace{0.3cm}{\ttfamily [protected]}}



The context cache maps all \hyperlink{classantlr4_1_1atn_1_1PredictionContext}{Prediction\+Context} objects that are equals() to a single cached copy. This cache is shared across all contexts in all A\+T\+N\+Configs in all D\+FA states. We rebuild each \hyperlink{classantlr4_1_1atn_1_1ATNConfigSet}{A\+T\+N\+Config\+Set} to use only cached nodes/graphs in add\+D\+F\+A\+State(). We don\textquotesingle{}t want to fill this during closure() since there are lots of contexts that pop up but are not used ever again. It also greatly slows down closure(). 

This cache makes a huge difference in memory and a little bit in speed. For the Java grammar on java.$\ast$, it dropped the memory requirements at the end from 25M to 16M. We don\textquotesingle{}t store any of the full context graphs in the D\+FA because they are limited to local context only, but apparently there\textquotesingle{}s a lot of repetition there as well. We optimize the config contexts before storing the config set in the D\+FA states by literally rebuilding them with cached subgraphs only. 

I tried a cache for use during closure operations, that was whacked after each adaptive\+Predict(). It cost a little bit more time I think and doesn\textquotesingle{}t save on the overall footprint so it\textquotesingle{}s not worth the complexity. 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
atn/A\+T\+N\+Simulator.\+h\item 
atn/A\+T\+N\+Simulator.\+cpp\end{DoxyCompactItemize}
